# Інструкції для запуску системи запису на прийом

## Крок 1: Налаштування сервера

1. Перейдіть до папки `dent-server`:
   ```bash
   cd C:\Users\sros0\Desktop\dent-server
   ```

2. Встановіть залежності:
   ```bash
   npm install
   ```

3. Налаштуйте конфігурацію в файлі `config.env`:
   - Замініть `YOUR_API_TOKEN_HERE` на ваш реальний токен CRM
   - Налаштуйте ID лікаря та кабінетів відповідно до вашої CRM системи

4. Запустіть сервер:
   ```bash
   npm start
   ```
   або для розробки:
   ```bash
   npm run dev
   ```

## Крок 2: Налаштування фронтенду

1. Відкрийте файл `index.html` у браузері
2. Переконайтеся, що сервер працює на порту 3000
3. Якщо сервер працює на іншому порту, змініть `SERVER_URL` в JavaScript коді

## Крок 3: Тестування

1. Відкрийте форму запису на прийом
2. Оберіть дату - система автоматично завантажить доступні години
3. Заповніть форму та відправте
4. Перевірте, що запис створився в CRM системі

## Особливості роботи

### Логіка доступних часів:
- Система генерує часові слоти з 9:00 до 19:00 з інтервалом 30 хвилин
- Перевіряє зайнятість по кожному кабінету окремо
- Показує час як доступний, якщо хоча б один кабінет вільний

### Створення запису:
1. Створює пацієнта в CRM
2. Визначає вільний кабінет для обраного часу
3. Створює запис на прийом
4. Відправляє email сповіщення

### Fallback механізм:
- Якщо CRM недоступний, система відправляє запис тільки через email
- Користувач отримує відповідне повідомлення

## Налагодження

### Перевірка підключення до CRM:
```bash
curl http://localhost:3000/api/health
```

### Перевірка доступних часів:
```bash
curl http://localhost:3000/api/available-times/2024-01-15
```

### Логи сервера:
Всі помилки та запити логуються в консоль сервера.

## Безпека

- API токен зберігається в змінних середовища
- CORS налаштований для роботи з фронтендом
- Валідація всіх вхідних даних
- Обробка помилок на всіх рівнях
